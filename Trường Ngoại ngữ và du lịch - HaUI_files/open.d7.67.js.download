/*vietlong.org 03/08/22 11:27:58*/
var dCaptcha={s7:"dcaptcha",width:150,height:50,length:4,token:"",r9:function(e){return"/apps/open/captcha?t="+this.token+"&l="+this.length+"&w="+this.width+"&h="+this.height+e},f5:function(e,t){dj("#hd"+this.s7).val(e),dj("#img"+this.s7).attr("src",t)},refresh:function(){var e=this;dj.getJSONP(e.r9(""),(function(t){0===t.err&&e.f5(t.token,t.imgurl)}))},init:function(e,t,i,a,n){if(this.s7=e,t&&t>0&&(this.width=t),i&&i>0&&(this.height=i),void 0!==a&&(this.length=a),void 0!==n&&(this.token=n),!document.getElementById("img"+e)){dj("#"+this.s7).before('<img id="img'+this.s7+'" class="captcha" /><input id="hd'+this.s7+'" type="hidden" name="'+this.s7+'captchatoken" />');var r=this;dj("#img"+this.s7).click((function(){r.refresh()}))}return""!==this.token?this.f5(this.token,this.r9("&i=1")):this.refresh(),this}}; /*! * Crop image v3.0 04/12/2015 * Copyright HoangNX */!function(e){e.dCrop=function(t,i){var a,n=e.extend({},e.dCrop.defaults),r=navigator.userAgent.toLowerCase(),o=/msie/.test(r),s=/msie [1-6]\./.test(r);function d(e){return Math.round(e)+"px"}function l(e){return n.baseClass+"-"+e}function c(t){var i=e(t).offset();return[i.left,i.top]}function u(e){return[e.pageX-a[0],e.pageY-a[1]]}function h(t){"object"!=typeof t&&(t={}),n=e.extend(n,t),e.each(["onChange","onSelect","onRelease","onDblClick"],(function(e,t){"function"!=typeof n[t]&&(n[t]=function(){})}))}function p(e,t,i){if(a=c(z),Q.setCursor("move"===e?e:e+"-resize"),"move"===e)return Q.activateHandlers(function(e){var t=e;return X.watchKeys(),function(e){J.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,G.update()}}(t),b,i);var r=J.getFixed(),o=f(e),s=J.getCorner(f(o));J.setPressed(J.getCorner(o)),J.setCurrent(s),Q.activateHandlers(function(e,t){return function(i){if(n.aspectRatio)switch(e){case"e":case"w":i[1]=t.y+1;break;case"n":case"s":i[0]=t.x+1}else switch(e){case"e":case"w":i[1]=t.y2;break;case"n":case"s":i[0]=t.x2}J.setCurrent(i),G.update()}}(e,r),b,i)}function f(e){switch(e){case"n":case"ne":return"sw";case"s":case"e":case"se":return"nw";case"w":case"sw":return"ne";case"nw":return"se"}}function m(e){return function(t){return!n.disabled&&(!("move"===e&&!n.allowMove)&&(a=c(z),q=!0,p(e,u(t)),t.stopPropagation(),t.preventDefault(),!1))}}function g(e,t,i){var a=e.width(),n=e.height();a>t&&t>0&&(a=t,n=t/e.width()*e.height()),n>i&&i>0&&(n=i,a=i/e.height()*e.width()),L=e.width()/a,B=e.height()/n,e.width(a).height(n)}function v(e){return{x:e.x*L,y:e.y*B,x2:e.x2*L,y2:e.y2*B,w:e.w*L,h:e.h*B}}function b(e){var t=J.getFixed();t.w>n.minSelect[0]&&t.h>n.minSelect[1]?(G.enableHandles(),G.done()):G.release(),Q.setCursor(n.allowSelect?"crosshair":"default")}function w(e){if(n.disabled)return!1;if(!n.allowSelect)return!1;q=!0,a=c(z),G.disableHandles(),Q.setCursor("crosshair");var t=u(e);return J.setPressed(t),G.update(),Q.activateHandlers(y,b,"touch"===e.type.substring(0,5)),X.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function y(e){J.setCurrent(e),G.update()}function j(){var t=e("<div></div>").addClass(l("tracker"));return o&&t.css({opacity:0,backgroundColor:"white"}),t}"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof i&&(i={}),h(i);var x={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},C=e(t),k=!0;if("IMG"===t.tagName){if(0!==C[0].width&&0!==C[0].height)C.width(C[0].width),C.height(C[0].height);else{var S=new Image;S.src=C[0].src,C.width(S.width),C.height(S.height)}var z=C.clone().removeAttr("id").css(x).show();z.width(C.width()),z.height(C.height()),C.after(z).hide()}else z=C.css(x).show(),k=!1,null===n.shade&&(n.shade=!0);g(z,n.boxWidth,n.boxHeight);var _=z.width(),A=z.height(),M=e("<div />").width(_).height(A).addClass(l("holder")).css({position:"relative",backgroundColor:n.bgColor}).insertAfter(C).append(z);n.addClass&&M.addClass(n.addClass);var O=e("<div />"),T=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),P=e("<div />").width("100%").height("100%").css("zIndex",320),I=e("<div />").css({position:"absolute",zIndex:600}).dblclick((function(){var e=J.getFixed();n.onDblClick.call(ne,e)})).insertBefore(z).append(T,P);k&&(O=e("<img />").attr("src",z.attr("src")).css(x).width(_).height(A),T.append(O)),s&&I.css({overflowY:"hidden"});var D,F,E,H,L,B,q,R,N=n.boundary,U=j().width(_+2*N).height(A+2*N).css({position:"absolute",top:d(-N),left:d(-N),zIndex:290}).mousedown(w),W=n.bgColor,K=n.bgOpacity;a=c(z);var V=function(){function e(){var e,t={},i=["touchstart","touchmove","touchend"],a=document.createElement("div");try{for(e=0;e<i.length;e++){var n=i[e],r=(n="on"+n)in a;r||(a.setAttribute(n,"return;"),r="function"==typeof a[n]),t[i[e]]=r}return t.touchstart&&t.touchend&&t.touchmove}catch(e){return!1}}return{createDragger:function(e){return function(t){return!n.disabled&&(!("move"===e&&!n.allowMove)&&(a=c(z),q=!0,p(e,u(V.cfilter(t)),!0),t.stopPropagation(),t.preventDefault(),!1))}},newSelection:function(e){return w(V.cfilter(e))},cfilter:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e},isSupported:e,support:!0===n.touchSupport||!1===n.touchSupport?n.touchSupport:e()}}(),J=function(){var e,t,i=0,a=0,r=0,o=0;function s(){if(!n.aspectRatio)return function(){var e,t=r-i,n=o-a;D&&Math.abs(t)>D&&(r=t>0?i+D:i-D);F&&Math.abs(n)>F&&(o=n>0?a+F:a-F);H/B&&Math.abs(n)<H/B&&(o=n>0?a+H/B:a-H/B);E/L&&Math.abs(t)<E/L&&(r=t>0?i+E/L:i-E/L);i<0&&(r-=i,i=0);a<0&&(o-=a,a=0);r<0&&(i-=r,r=0);o<0&&(a-=o,o=0);r>_&&(i-=e=r-_,r-=e);o>A&&(a-=e=o-A,o-=e);i>_&&(o-=e=i-A,a-=e);a>A&&(o-=e=a-A,a-=e);return c(l(i,a,r,o))}();var e,t,s,d,u=n.aspectRatio,h=n.minSize[0]/L,p=n.maxSize[0]/L,f=n.maxSize[1]/B,m=r-i,g=o-a,v=Math.abs(m),b=Math.abs(g);return 0===p&&(p=10*_),0===f&&(f=10*A),v/b<u?(t=o,s=b*u,(e=m<0?i-s:s+i)<0?(e=0,d=Math.abs((e-i)/u),t=g<0?a-d:d+a):e>_&&(e=_,d=Math.abs((e-i)/u),t=g<0?a-d:d+a)):(e=r,d=v/u,(t=g<0?a-d:a+d)<0?(t=0,s=Math.abs((t-a)*u),e=m<0?i-s:s+i):t>A&&(t=A,s=Math.abs(t-a)*u,e=m<0?i-s:s+i)),e>i?(e-i<h?e=i+h:e-i>p&&(e=i+p),t=t>a?a+(e-i)/u:a-(e-i)/u):e<i&&(i-e<h?e=i-h:i-e>p&&(e=i-p),t=t>a?a+(i-e)/u:a-(i-e)/u),e<0?(i-=e,e=0):e>_&&(i-=e-_,e=_),t<0?(a-=t,t=0):t>A&&(a-=t-A,t=A),c(l(i,a,e,t))}function d(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>_&&(e[0]=_),e[1]>A&&(e[1]=A),[Math.round(e[0]),Math.round(e[1])]}function l(e,t,i,a){var n=e,r=i,o=t,s=a;return i<e&&(n=i,r=e),a<t&&(o=a,s=t),[n,o,r,s]}function c(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}return{flipCoords:l,setPressed:function(e){e=d(e),r=i=e[0],o=a=e[1]},setCurrent:function(i){i=d(i),e=i[0]-r,t=i[1]-o,r=i[0],o=i[1]},getOffset:function(){return[e,t]},moveOffset:function(e){var t=e[0],n=e[1];0>i+t&&(t-=t+i),0>a+n&&(n-=n+a),A<o+n&&(n+=A-(o+n)),_<r+t&&(t+=_-(r+t)),i+=t,r+=t,a+=n,o+=n},getCorner:function(e){var t=s();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}},getFixed:s}}(),$=function(){var t=!1,i=e("<div />").css({position:"absolute",zIndex:240,opacity:0}),a={top:s(),left:s().height(A),right:s().height(A),bottom:s()};function r(){return o(J.getFixed())}function o(e){a.top.css({left:d(e.x),width:d(e.w),height:d(e.y)}),a.bottom.css({top:d(e.y2),left:d(e.x),width:d(e.w),height:d(A-e.y2)}),a.right.css({left:d(e.x2),width:d(_-e.x2)}),a.left.css({width:d(e.x)})}function s(){return e("<div />").css({position:"absolute",backgroundColor:n.shadeColor||n.bgColor}).appendTo(i)}function l(){t||(t=!0,i.insertBefore(z),r(),G.setBgOpacity(1,0,1),O.hide(),c(n.shadeColor||n.bgColor,1),G.isAwake()?h(n.bgOpacity,1):h(1,1))}function c(e,t){ie(p(),e,t)}function u(){t&&(i.remove(),O.show(),t=!1,G.isAwake()?G.setBgOpacity(n.bgOpacity,1,1):(G.setBgOpacity(1,1,1),G.disableHandles()),ie(M,0,1))}function h(e,a){t&&(n.bgFade&&!a?i.animate({opacity:1-e},{queue:!1,duration:n.fadeTime}):i.css({opacity:1-e}))}function p(){return i.children()}return{update:r,updateRaw:o,getShades:p,setBgColor:c,enable:l,disable:u,resize:function(e,t){a.left.css({height:d(t)}),a.right.css({height:d(t)})},refresh:function(){n.shade?l():u(),G.isAwake()&&h(n.bgOpacity)},opacity:h}}(),G=function(){var t,i=370,a={},r={},o={},s=!1;function c(t,i){var a=e("<div />").mousedown(m(t)).css({cursor:t+"-resize",position:"absolute",zIndex:i}).addClass("ord-"+t);return V.support&&a.bind("touchstart.dcrop",V.createDragger(t)),P.append(a),a}function u(){var e=J.getFixed();J.setPressed([e.x,e.y]),J.setCurrent([e.x2,e.y2]),h()}function h(e){if(t)return p(e)}function p(e){var i,a,r,o,s=J.getFixed();i=s.w,a=s.h,I.width(Math.round(i)).height(Math.round(a)),r=s.x,o=s.y,n.shade||O.css({top:d(-o),left:d(-r)}),I.css({top:d(o),left:d(r)}),n.shade&&$.updateRaw(s),t||function(){I.show(),n.shade?$.opacity(K):f(K,!0);t=!0}(),e?n.onSelect.call(ne,v(s)):n.onChange.call(ne,v(s))}function f(e,i,a){(t||i)&&(n.bgFade&&!a?z.animate({opacity:e},{queue:!1,duration:n.fadeTime}):z.css("opacity",e))}function g(){if(s=!0,n.allowResize)return P.show(),!0}function b(){s=!1,P.hide()}function w(e){e?(R=!0,b()):(R=!1,g())}n.dragEdges&&e.isArray(n.createDragbars)&&function(e){var t;for(t=0;t<e.length;t++)o[e[t]]=c(e[t],i++).addClass("dcrop-dragbar")}(n.createDragbars),e.isArray(n.createHandles)&&function(e){var t,a,o,s;for(t=0;t<e.length;t++)r[e[t]]=(a=e[t],o=void 0,s=void 0,o=n.handleSize,s=c(a,i++).css({opacity:n.handleOpacity}).addClass(l("handle")),o&&s.width(o).height(o),s)}(n.createHandles),n.drawBorders&&e.isArray(n.createBorders)&&function(t){var i,r,o,s;for(r=0;r<t.length;r++){switch(t[r]){case"n":i="hline";break;case"s":i="hline bottom";break;case"e":i="vline right";break;case"w":i="vline"}a[t[r]]=(o=i,s=void 0,s=e("<div />").css({position:"absolute",opacity:n.borderOpacity}).addClass(l(o)),T.append(s),s)}}(n.createBorders),e(document).bind("touchstart.dcrop-ios",(function(t){e(t.currentTarget).hasClass("dcrop-tracker")&&t.stopPropagation()}));var y=j().mousedown(m("move")).css({cursor:"move",position:"absolute",zIndex:360});return V.support&&y.bind("touchstart.dcrop",V.createDragger("move")),T.append(y),b(),{updateVisible:h,update:p,release:function(){b(),I.hide(),n.shade?$.opacity(1):f(1),t=!1,n.onRelease.call(ne)},refresh:u,isAwake:function(){return t},setCursor:function(e){y.css("cursor",e)},enableHandles:g,enableOnly:function(){s=!0},showHandles:function(){s&&P.show()},disableHandles:b,animMode:w,setBgOpacity:f,done:function(){w(!1),u()}}}(),Q=function(){var t=function(){},i=function(){},a=n.trackDocument;function r(e){return t(u(e)),!1}function o(a){return a.preventDefault(),a.stopPropagation(),q&&(q=!1,i(u(a)),G.isAwake()&&n.onSelect.call(ne,v(J.getFixed())),U.css({zIndex:290}),e(document).unbind(".dcrop"),t=function(){},i=function(){}),!1}function s(e){return t(u(V.cfilter(e))),!1}function d(e){return o(V.cfilter(e))}return a||U.mousemove(r).mouseup(o).mouseout(o),z.before(U),{activateHandlers:function(n,l,c){return q=!0,t=n,i=l,function(t){U.css({zIndex:450}),t?e(document).bind("touchmove.dcrop",s).bind("touchend.dcrop",d):a&&e(document).bind("mousemove.dcrop",r).bind("mouseup.dcrop",o)}(c),!1},setCursor:function(e){U.css("cursor",e)}}}(),X=function(){var t=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("dcrop-keymgr"),i=e("<div />").css({position:"absolute",overflow:"hidden"}).append(t);function a(e,t,i){n.allowMove&&(J.moveOffset([t,i]),G.updateVisible(!0)),e.preventDefault(),e.stopPropagation()}return n.keySupport&&(t.keydown((function(e){if(e.ctrlKey||e.metaKey)return!0;var t=!!e.shiftKey?10:1;switch(e.keyCode){case 37:a(e,-t,0);break;case 39:a(e,t,0);break;case 38:a(e,0,-t);break;case 40:a(e,0,t);break;case 27:n.allowSelect&&G.release();break;case 9:return!0}return!1})).blur((function(e){t.hide()})),s||!n.fixedSupport?(t.css({position:"absolute",left:"-20px"}),i.append(t).insertBefore(z)):t.insertBefore(z)),{watchKeys:function(){n.keySupport&&(t.show(),t.focus())}}}();function Y(e){Z([e[0]/L,e[1]/B,e[2]/L,e[3]/B]),n.onSelect.call(ne,v(J.getFixed())),G.enableHandles()}function Z(e){J.setPressed([e[0],e[1]]),J.setCurrent([e[2],e[3]]),G.update()}function ee(){n.disabled=!0,G.disableHandles(),G.setCursor("default"),Q.setCursor("default")}function te(){n.disabled=!1,ae()}function ie(t,i,a){var r=i||n.bgColor;n.bgFade&&e.fx.step.hasOwnProperty("backgroundColor")&&n.fadeTime&&!a?t.animate({backgroundColor:r},{queue:!1,duration:n.fadeTime}):t.css("backgroundColor",r)}function ae(e){n.allowResize?e?G.enableOnly():G.enableHandles():G.disableHandles(),Q.setCursor(n.allowSelect?"crosshair":"default"),G.setCursor(n.allowMove?"move":"default"),n.hasOwnProperty("trueSize")&&(L=n.trueSize[0]/_,B=n.trueSize[1]/A),n.hasOwnProperty("setSelect")&&(Y(n.setSelect),G.done(),delete n.setSelect),$.refresh(),n.bgColor!==W&&(ie(n.shade?$.getShades():M,n.shade&&n.shadeColor||n.bgColor),W=n.bgColor),K!==n.bgOpacity&&(K=n.bgOpacity,n.shade?$.refresh():G.setBgOpacity(K)),D=n.maxSize[0]||0,F=n.maxSize[1]||0,E=n.minSize[0]||0,H=n.minSize[1]||0,n.hasOwnProperty("outerImage")&&(z.attr("src",n.outerImage),delete n.outerImage),G.refresh()}V.support&&U.bind("touchstart.dcrop",V.newSelection),P.hide(),ae(!0);var ne={setImage:function(e,t){G.release(),ee();var i=new Image;i.onload=function(){var a=i.width,r=i.height,o=n.boxWidth,s=n.boxHeight;z.width(a).height(r),z.attr("src",e),O.attr("src",e),g(z,o,s),_=z.width(),A=z.height(),O.width(_).height(A),U.width(_+2*N).height(A+2*N),M.width(_).height(A),$.resize(_,A),te(),"function"==typeof t&&t.call(ne)},i.src=e},animateTo:function(e,t){var i=e[0]/L,a=e[1]/B,r=e[2]/L,o=e[3]/B;if(!R){var s=J.flipCoords(i,a,r,o),d=J.getFixed(),l=[d.x,d.y,d.x2,d.y2],c=l,u=n.animationDelay,h=s[0]-l[0],p=s[1]-l[1],f=s[2]-l[2],m=s[3]-l[3],g=0,v=n.swingSpeed;i=c[0],a=c[1],r=c[2],o=c[3],G.animMode(!0);var b=function(){g+=(100-g)/v,c[0]=Math.round(i+g/100*h),c[1]=Math.round(a+g/100*p),c[2]=Math.round(r+g/100*f),c[3]=Math.round(o+g/100*m),g>=99.8&&(g=100),g<100?(Z(c),w()):(G.done(),G.animMode(!1),"function"==typeof t&&t.call(ne))};w()}function w(){window.setTimeout(b,u)}},setSelect:Y,setOptions:function(e){h(e),ae()},tellSelect:function(){return v(J.getFixed())},tellScaled:function(){return J.getFixed()},setClass:function(e){M.removeClass().addClass(l("holder")).addClass(e)},disable:ee,enable:te,cancel:function(){G.done(),Q.activateHandlers(null,null)},release:G.release,destroy:function(){M.remove(),C.show(),C.css("visibility","visible"),e(t).removeData("dCrop")},focus:X.watchKeys,getBounds:function(){return[_*L,A*B]},getWidgetSize:function(){return[_,A]},getScaleFactor:function(){return[L,B]},getOptions:function(){return n},ui:{holder:M,selection:I}};return o&&M.bind("selectstart",(function(){return!1})),C.data("dCrop",ne),ne},e.fn.dCrop=function(t,i){var a;return this.each((function(){if(e(this).data("dCrop")){if("api"===t)return e(this).data("dCrop");e(this).data("dCrop").setOptions(t)}else"IMG"===this.tagName?e.dCrop.Loader(this,(function(){e(this).css({display:"block",visibility:"hidden"}),a=e.dCrop(this,t),e.isFunction(i)&&i.call(a)})):(e(this).css({display:"block",visibility:"hidden"}),a=e.dCrop(this,t),e.isFunction(i)&&i.call(a))})),this},e.dCrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"dcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}},e.dCrop.Loader=function(t,i,a){var n=e(t),r=n[0];n.bind("load.jcloader",(function t(){r.complete?(n.unbind(".jcloader"),e.isFunction(i)&&i.call(r)):window.setTimeout(t,50)})).bind("error.jcloader",(function(t){n.unbind(".jcloader"),e.isFunction(a)&&a.call(r)})),r.complete&&e.isFunction(i)&&(n.unbind(".jcloader"),i.call(r))}}(djCore); /*! * Tinymce editor v4.0 09/06/2018 * Copyright HoangNX */ var dcloze={renderView:function(e){dj(e+" .cloze_mcu input[type='checkbox']").iCheck({checkboxClass:"icheckbox_square-green"}),dj(e+" .cloze_mcu input[type='radio']").iCheck({radioClass:"iradio_square-green"})},submitAnswer:function(e){var t=[];return dj(e+">.dgqs").each((function(){var e=dj(this),i={},a=!1;dj(".cloze_mwi,.cloze_mcs,.cloze_mcu",e).each((function(){var e=dj(this),t=e.attr("id"),n=e.attr("dsort"),r=void 0!==n?n:"";if(e.hasClass("cloze_mwi")){var o=dj.trim(e.val());""!==o&&(i[t]={v:o},a=!0)}else if(e.hasClass("cloze_mcs")){var s=parseInt(e.val());s>=0&&(i[t]={v:s,o:r},a=!0)}else if(e.hasClass("cloze_mcu")){var d=[];dj("#"+t+" input.deck").each((function(){var e=dj(this);e.iCheck("update")[0].checked&&d.push(parseInt(e.val()))})),d.length>0&&(i[t]={v:e.hasClass("uradio")?d[0]:d,o:r},a=!0)}}));var n=dj(".flag",e).hasClass("active");if(n||a){var r=e.attr("rel"),o=e.attr("dsort");t.push({id:r,ans:i,flag:n?1:0,dsort:o})}})),t},userLogs:function(e){for(var t in e){var i=e[t];for(var a in i){var n=dj("#d"+t+"q_"+a),r=i[a];if(n.length>0){var o=n.attr("rel");if(dj.inArray(o,["mw","mwc","nm"])>-1)n.val(r);else if(dj.inArray(o,["mc","mcs"])>-1)n.val(r);else if(dj.inArray(o,["mav","mah","mavs","mahs"])>-1)for(var s in r){var d=r[s];dj("input.deck[value='"+d+"']",n).prop("checked",!0).parent().addClass("checked")}else dj.inArray(o,["mcv","mch","mcvs","mchs"])>-1&&dj("input.deck[value='"+r+"']",n).prop("checked",!0).parent().addClass("checked")}}}},showAnswer:function(e){for(var t in e){var i=e[t];if(dj.inArray(i.t,["mw","mwc","nm"])>-1)for(var a in i.a)1===i.a[a].g&&dj("#"+t).val(i.a[a].v);else if(dj.inArray(i.t,["mc","mcs"])>-1)for(var a in i.a)1===i.a[a].g&&dj("#"+t).val(i.a[a].i);else if(dj.inArray(i.t,["mcv","mch","mcvs","mchs","mav","mah","mavs","mahs"])>-1)for(var a in dj("#"+t+" input.deck").prop("checked",!1).parent().removeClass("checked"),i.a)if(1===i.a[a].g){var n=i.a[a].i;dj("#"+t+" input.deck[value='"+n+"']").prop("checked",!0).parent().addClass("checked")}}},showFeedback:function(e,t){for(var i in dj(e+" i.dgaw").remove(),t){var a=t[i],n=dj("#"+i);a.icon=a.chk?"fa-thumbs-up":"fa-thumbs-o-down";var r=djTemplate.render('<i title="{percent}% - {feedback}" class="dgaw fa {icon}"></i>',a);dj(r).insertAfter(n)}return!1}},dgeditor=function(){var e="4.7.1.18",t={id:"",enabled:!1,length:10,templates:[{id:"title-only",title:"Chỉ tiêu đề"},{id:"title-and-sapo",title:"Tiêu đề và tóm tắt"},{id:"title-and-thumb",title:"Tiêu đề và ảnh đại diện"},{id:"title-thumb-and-sapo",title:"Tiêu đề, ảnh và tóm tắt"}],callback:function(e,t,i,a){}},i={vote:!0,type:"MCV"},a={enabled:!1,language:"vi",allow_deep:!1,perplexity:.976,replace_word:!0,callback:function(e,t,i,a){}},n={language:"vi_VN",dspellchk:a,drelated_news:t,dclozetest:i,server:djConfig.BASE_URL,select_image_after_upload:!1,uploader:"news",videoframe:!1,gmap:{address:"Hồ Hoàn Kiếm, Hà Nội",lat:21.029059572595347,lng:105.8524248719666,zoom:16},imgcrop:{width:0,height:0},question_typeid:1};return{p2:null,j7:null,l2:null,l3:"",path:function(e,t){return this.o3(e,t)},embedContent:function(e,t,i,a,n,r){if(i.length>0&&""!==a){void 0===n&&(n="Tin liên quan:");var o=this.o3("/templates/related/"+a+".html",!0);dj.get(o,(function(o){if(""!==o){var s=['<div class="drelated"><strong>'+n+'</strong><ul class="'+a+'">'];for(var d in i){var l=i[d],c=t[l];s.push(djTemplate.render(o,c))}s.push('</ul><div class="clr"></div></div>'),e.execCommand("mceInsertContent",!1,s.join("")),dj.isFunction(r)&&r(s)}}))}},o3:function(t,i){void 0===i&&(i=!1);var a=(i?"/":djConfig.CDN_URL)+"dgrs/editor/tinymce."+e;return void 0!==t&&(a+=t),a},editor:function(e){return void 0!==e&&""!==e||(e=this.p2.id),tinymce.get(e)},getContent:function(e){var t=this.editor(e);return t?t.getContent():""},content:function(e,t){var i=this.editor(t);return i?void 0===e?i.getContent():i.setContent(e):""},tinyConfig:function(r,o){var s={cache_suffix:"?v="+e,branding:!0,min_width:300,width:720,max_width:800,min_height:200,height:395,max_height:600,theme:"modern",plugins:["autolink autosave link lists charmap preview searchreplace fullscreen colorpicker code dSpellchk","imagetools autosave","contextmenu print nonbreaking table template paste textcolor textpattern code wordcount fullpage","dReader dImage dMedia dAttach dHtml dMap dFormat dChkrs dPasteOffice"],toolbar:["undo redo | cut copy paste dPasteOffice | superscript charmap link template table | dReader dImage dMedia dAttach dHtml dMap | dFormat dChkrs dSpellchk","styleselect forecolor backcolor | bold italic underline | outdent indent | alignleft aligncenter alignright alignjustify | searchreplace code fullscreen preview print"],menubar:!1,contextmenu:"dImage dCropImg dWatermarkImage dMedia link | tableprops deletetable cell row column",imagetools_toolbar:"rotateleft rotateright | flipv fliph | editimage imageoptions",autosave_interval:"300s",autosave_retention:"30m",autosave_restore_when_empty:!0,autosave_ask_before_unload:!1,readonly:!1,resize:!1,statusbar:!0,schema:"html5",encoding:"xml",entity_encoding:"raw",element_format:"xhtml",content_css:[],style_formats:[{title:"Tiêu đề",block:"h1",classes:"pTitle"},{title:"Tóm tắt",block:"p",classes:"pHead"},{title:"Nội dung",block:"p",classes:"pBody"},{title:"Chú thích",block:"p",classes:"pCaption"},{title:"Tác giả",block:"p",classes:"pAuthor"},{title:"Nguồn bài",block:"p",classes:"pSource"},{title:"Tên đoạn",block:"p",classes:"pInterTitle"},{title:"Liên kết",block:"p",classes:"pLink"},{title:"Câu hỏi",block:"div",classes:"dQuestion"},{title:"Trả lời",block:"div",classes:"dAnswer"},{title:"Căn trái",selector:"img,table",styles:{margin:"0 4px",float:"left"}},{title:"Căn giữa",selector:"img,table",styles:{"margin-left":"auto","margin-right":"auto"}},{title:"Căn phải",selector:"img,table",styles:{margin:"0 4px",float:"right"}}],gecko_spellcheck:!1,relative_urls:!1,table_grid:!1,table_advtab:!0,table_row_advtab:!0,table_cell_advtab:!1,table_tab_navigation:!1,table_appearance_options:!1,table_class_list:[{title:"Bảng",value:"dtbln"},{title:"Box XANH nhạt",value:"xanhnhat"},{title:"Box CAM 1",value:"camnhat"},{title:"Box CAM 2",value:"camtren"},{title:"Box bảng biểu",value:"bangbieu"},{title:"Box khung viền",value:"khungvien"}],templates:[{title:"Khối XANH nhạt",url:this.o3("/templates/box/xanh-nhat.html",!0)},{title:"Khối CAM 1",url:this.o3("/templates/box/cam-nhat.html",!0)},{title:"Khối CAM 2",url:this.o3("/templates/box/cam-tren.html",!0)},{title:"Ảnh/chú thích",url:this.o3("/templates/box/anh-chu-thich.html",!0)},{title:"Khối trích dẫn 1",url:this.o3("/templates/box/trich-dan-1.html",!0)},{title:"Khối trích dẫn 2",url:this.o3("/templates/box/trich-dan-2.html",!0)},{title:"Tiêu đề trích dẫn",content:'<h1 class="pTitle">“Nội dung trích dẫn cho tiêu đề”</h1>'}],table_toolbar:"",body_class:"dbody",mobile:{theme:"modern",plugins:["link nonbreaking paste textpattern code","dFormat"],toolbar:["undo redo | cut copy paste | link dFormat code","styleselect | bold italic underline | alignleft aligncenter alignright alignjustify"]},init_instance_callback:function(e){djLog("Dragon editor "+e.id+" is now initialized.")}};this.p2=dj.extend(n,r);var d=dj.extend(s,o);this.l3="\\/"+this.p2.uploader+"\\/(\\d+/\\d+d\\d+[^\\.]+.(jpe?g|png|gif|bmp))";var l=dj.extend(d,{mobile:this.p2.mobile,language:this.p2.language,drelated_news:dj.extend(t,this.p2.drelated_news),dclozetest:dj.extend(i,this.p2.dclozetest),dspellchk:dj.extend(a,this.p2.dspellchk),server:this.p2.server,uploader:this.p2.uploader,baseURL:this.o3(),videoframe:this.p2.videoframe,gmap:this.p2.gmap,imgcrop:this.p2.imgcrop,question_typeid:this.p2.question_typeid});return void 0!==this.p2.id&&(l.editor_selector="mce"+this.p2.id,l.selector="#"+this.p2.id,l.auto_focus=this.p2.id),void 0!==this.p2.selector&&(l.selector=this.p2.selector),d.readonly&&(l.plugins=[],l.toolbar=[]),l},init:function(e,t,i){this.l2=this.tinyConfig(e,t);var a=this,n=this.o3("/detm1.min.js");return dj.ajax({url:n,dataType:"script",cache:!0,success:function(){a.s2(),dj.isFunction(i)&&i()}}),this},s2:function(){document.domain=djConfig.DOMAIN,tinymce.init(this.l2)},c7:function(e,t){return e.replace(new RegExp("<"+t+"[^>]*>")," ").replace(new RegExp("</"+t+">")," ").replace(/\s{2}/gi," ")},removeHtmlTags:function(e,t){var i=this;return e=e.replace(/<\/?(\w+)[^>]*>/gi,(function(e,a){return void 0!==t?-1===dj.inArray(a.toLowerCase(),t)?i.c7(e,a):e:i.c7(e,a)})),dj.trim(e.replace(/\s{2}/gi," "))},getTitle:function(e){var t=dgeditor.getElements(e,".pTitle").html();return(t=this.removeHtmlTags(t,["sub","sup"])).replace(/`([^``]*)`/gi,(function(e,t){return"“"+t+"”"})).replace(/’([^’’]*)’/gi,(function(e,t){return"“"+t+"”"})).replace(/"([^""]*)"/gi,(function(e,t){return"“"+t+"”"})).replace(/'([^'']*)'/gi,(function(e,t){return"“"+t+"”"}))},clearHtml:function(e){return e=(e=(e=(e=(e=this.formatHtml(e,"cms")).replace(/<\/?(header|nav|br|source|section|picture|article|aside|footer|details|summary|fieldset|legend|frame|figure|main)([^>]*\/?)?>/gi,"")).replace(/<img\s+([^>]+)\/?>/gi,(function(e,t){var i=[],a=["src","alt","title","style","width","height"];for(var n in a){var r=a[n],o=new RegExp(r+"=(?:'|\")([^('|\")]+)(?:'|\")"),s=t.match(o);s&&""!==s[1]&&i.push(r+'="'+s[1]+'"')}return i.length>0?"<img "+i.join(" ")+" />":""}))).replace(/<(\/)?(h\d+|p|div)[^>]*>/gi,"<$1p>")).replace(/<p>(\n|\t|\s*)<\/p>/gi,"")},j8:function(e){return e=(e=(e=(e=(e=e.replace(/<\/?(html|head|body|base|meta|style|title|script)([^>]*\/?)?>/gi,"")).replace(/<\/?(pre|form|input|label|option|select|button|fieldset|textarea|noframes|noscript)([^>]*\/?)?>/gi,"")).replace(/<\/?(font|span|strong|strike|em|center|big|small|address)([^>]*\/?)?>/gi,"")).replace(/<\/?(ol|ul|li)([^>]*\/?)?>/gi,"")).replace(/<\/?(abbr|acronym|bdo|cite|del|dfn|dl|ins|kbd|map|pre|q|samp|tt)([^>]*\/?)?>/gi,"")},formatHtml:function(e,t){void 0===t&&(t="cms"),e=(e=(e=(e=(e=e.replace(/\s{2}/gi," ")).replace(/(&nbsp;){2}/gi,"")).replace(/(^(<p[^>]*>(\s|&nbsp;|<br[^>]*>)*<\/p>\s*)+|(<p[^>]*>(\s|&nbsp;|<br[^>]*>)*<\/p>\s*)+$)/gi,"")).replace(/<script[^>]*>([^\x3C]+)<\/script>/gi,"")).replace(/<link[^>]+>/gi,""),e=(e=this.j8(e)).replace(/<\/?(h2|h3|h4|h5|h6)([^>]*\/?)?>/gi,""),"cms"===t&&(e=e.replace(/<\/?(mark|article|figure|figcaption)[^>]*>/gi,"")),e=(e=(e=e.replace(/\<\!--[^-]+--\>/gi,"")).replace(/<(p|div|span)[^>]*>(&nbsp;\s*)*<\/(p|div|span)>/gi,"")).replace(/<\/?\w+:[^>]+>/gi,""),"cms"===t&&(e=e.replace(/<(\/)?(div|article)[^>]*>/gi,"<$1p>"));var i=-1;return e=e.replace(/<p[^>]*>\s*(.*?)\s*<\/p>/gi,(function(a,n,r,o){if(0===++i){if("livenews"!==t&&-1===e.indexOf("pTitle"))return'<h1 class="pTitle">'+n+"</h1>";if("cms"===t)return'<p class="pHead">'+n+"</p>"}return"cms"===t&&1===i&&-1===e.indexOf("pHead")?'<p class="pHead">'+n+"</p>":-1===a.indexOf("pBody")&&-1===a.indexOf("pSpin")&&-1===a.indexOf("pHead")&&-1===a.indexOf("pCaption")&&-1===a.indexOf("pAuthor")&&-1===a.indexOf("pSource")&&-1===a.indexOf("pInterTitle")&&-1===a.indexOf("pLink")?'<p class="pBody">'+n+"</p>":a}))},formatCloze:function(e){return e=e.replace(/<div([^>]*)>\s*(<mark[^>]*>)/gi,(function(e,t,i){return-1===t.indexOf("dAnswer")?'<div class="dAnswer">'+i:e}))},formatQuestionCloze:function(e){return e=(e=(e=(e=(e=e.replace(/<p([^>]+)>/gi,"<p>")).replace(/<div([^>]*)>/gi,"")).replace(/<\/div>/gi,"")).replace(/<mark[^>]*>/gi,'<div class="dAnswer"><mark>')).replace(/<\/mark>/gi,"</mark></div>"),(e=this.j8(e)).replace(/\s{2}/gi," ")},l5:function(e){return!1},upload:function(e,t,i,a,n){void 0===a&&(a="0"),void 0!==n&&(this.l5=n),void 0===i&&(i=""),dLoading.show();var r=e.parentNode,o=[this.p2.server,"modules/goku/editor/upload",this.p2.uploader,t];return r.setAttribute("action",o.join("/")+"?argument="+a+"&editorid="+i+"&callback=dgeditor.h4"),r.submit(),!1},h4:function(e,t){if(dLoading.hide(),0===t.err){var i=this.editor(e);"pasteoffice"===t.argument?i.plugins.dPasteOffice.uploaded(t):"image"===t.type?i.plugins.dImage.uploaded(t):"file"===t.type?i.plugins.dAttach.uploaded(t):"thumb"===t.type?i.plugins.dMedia.thumbUploaded(t):"media"===t.type&&i.plugins.dMedia.mediaUploaded(t),this.l5(t);var a=[];dj.inArray(t.type,["image","thumb"])>-1&&a.push('<img style="float:left;margin:0 2px;width:80px;max-height:80px" src="{src}" />'),dj.inArray(t.type,["media"])>-1&&a.push("MEDIA [{sratio}] {width}x{height} / {sduration}"),a.push("<p>Upload {type} {file} <br/><b>{size}</b> thành công!</p>"),dWin.noise(djTemplate.render(a.join(""),t),3e3)}else alert("Không thể upload file (nghi ngờ chứa mã không an toàn). "+t.msg)},getMyImgSrc:function(e){var t=e.match(this.l3);return t?t[1]:""},getElements:function(e,t){return void 0===e&&(e=this.editor()),void 0===t&&(t="img"),e.$(t)},getFirstMedia:function(e){return this.getElements(e,"img.dgmedia:first")},getMyMedias:function(e){return this.getElements(e,"img.dgmedia")},getMyImgs:function(e,t){var i=this.getElements(e,t),a=[];if(i)for(var n in i){var r=i[n],o=r.src;if(o&&""!==o){var s=this.getMyImgSrc(o);""===s||-1!==dj.inArray(s,a)||this.imgIsMedia(r)||a.push(s)}}return a},imgIsMedia:function(e){var t=dj(e).attr("data-encode");return void 0!==t&&""!==t},saveExtenalImages:function(e,t){var i=this.getElements(e,"img");if(i&&i.length>0){var a={},n={},r=!1;for(var o in i){var s=i[o],d=s.src,l=dj.sec(d);if(d&&""!==d&&""===this.getMyImgSrc(d)&&!this.imgIsMedia(s)){if(0===d.indexOf("blob:")){var c=e.editorUpload.blobCache.getByUri(d);c&&(a[l]="data:"+c.blob().type+";base64,"+c.base64())}else a[l]=d;n[l]=s,r=!0}}if(r){var u=[this.p2.server,"modules/goku/editor/save_extenal_images",this.p2.uploader];dj.postJSON(u.join("/"),a,(function(e){if(0===e.err){for(var i in e.data){var a=n[i],r=e.data[i];a.src=r,a.removeAttribute("data-mce-src")}t(e)}else dDialog.alertError("Không thể lấy ảnh tự động cho văn bản")}))}else t(null)}else t(null);return!1}}}(),dgridUpload={r9:function(e){var t=[];for(var i in e)t.push(i+"="+encodeURIComponent(e[i]));return djConfig.BASE_URL+"/modules/goku/utility/grid_upload?"+t.join("&")},p2:{folder:"eoffice/test",overwrite:!1,cross_origin:!1,onChange:function(e){return!1},onSubmit:function(e){return!1},onSuccess:function(e){return!1}},p4:function(e){var t=Math.floor(999999*Math.random()),i=[e.folder,e.subfolder,e.filename],a=""===e.subfolder||"0"===e.subfolder?e.filename:e.subfolder+"/"+e.filename;return dj.extend(e,{value:a,filesize:dj.fileSize(e.fsize),url:djConfig.MEDIA_URL+i.join("/")+"?_r="+t})},init:function(e,t){var i=dj.sec(e),a="gridupload"+i,n=dj.extend({},this.p2,t);dj(e).each((function(e){var t=dj(this),a=t.attr("title"),n=void 0===a?"Upload tệp":a,r=t.attr("name"),o=void 0===r?"druf":r,s=t.attr("maxsize"),d=void 0===s?10485760:parseInt(s),l=t.attr("ext"),c=void 0===l?"jpeg,jpg,gif,png,docx,xlsx,zip":l,u=t.attr("subfolder"),h=void 0===u?"":u,p=t.attr("argument"),f=void 0===p?"":p,m=t.attr("imgmaxw"),g=void 0===m?0:parseInt(m);t.parent().addClass("tdc"),t.replaceWith(djTemplate.render('<input type="text" name="{name}" class="imedia form-control input-sm" value="{value}" disabled="disabled"/><form class="fmedia fd{eid}" enctype="multipart/form-data" method="post" target="up_frame{name}{idx}" title="{tooltip}"><label for="uploadfile{name}{idx}" class="btn btn-info">{title}</label><input id="uploadfile{name}{idx}" name="dGridUpload" class="dgupload" rel="{value}" type="file" maxsize="{maxsize}" ext="{exts}" field="{name}" subfolder="{subfolder}" argument="{argument}" idx="{idx}" imgmaxw="{imgmaxw}" /><iframe name="up_frame{name}{idx}" frameborder="0"></iframe></form>',{value:t.val(),name:o,title:n,tooltip:djTemplate.render("Cho phép Upload tệp {exts} tối đa {maxsize}.",{maxsize:dj.fileSize(d),exts:c}),subfolder:h,maxsize:d,exts:c,argument:f,imgmaxw:g,eid:i,idx:i+e}))}));var r=this;dj(".fd"+i+">input.dgupload").change((function(e){var t=dj(this),i=t.attr("rel"),o="imedia"+t.attr("idx"),s=parseInt(t.attr("maxsize")),d=t.attr("ext"),l=t.attr("field"),c=t.attr("subfolder"),u=t.attr("argument"),h=t.attr("imgmaxw");t.parent().parent().find("input.imedia").attr("id",o),n.onChange(this);var p=e.target.value,f=e.currentTarget.files;if(""!==p&&f.length>0){var m=f[0].size,g=p.toLowerCase().replace(/^.*\./,"");dj.inArray(g,d.split(","))>-1?m<=s?(n.cross_origin&&(document.domain=djConfig.HOST),n.onSubmit(e),dj(e.target).parent().attr("action",r.r9({tid:o,fn:a,filename:i,argument:u,imgmaxw:h,field:l,folder:n.folder,subfolder:c,overwrite:n.overwrite?1:0,crossorigin:n.cross_origin?1:0,maxsize:s,sec:dj.sec(n.folder+"*"+o+"@"+s)})).submit()):dDialog.alertError(djTemplate.render("Tệp tin <b>{fsize}</b> vượt quá dung lượng <b>{maxsize}</b> cho phép.",{fsize:dj.fileSize(m),maxsize:dj.fileSize(s)})):dDialog.alertError("Không hỗ trợ upload tệp tin này, chỉ cho phép upload tệp <b>"+d.toUpperCase()+"</b>")}})),window[a]=function(e){if(0===e.err){var t=dj("#"+e.txtid),i=r.p4(e);return n.cross_origin||dj(".fmedia",t.parent()).hide(),t.val(i.value).addClass("hasfile"),dWin.noise(djTemplate.render("Upload Tệp tin <b>{filetitle} {filesize}</b> thành công!",i),3e3,{action:"success",preventDuplicates:!0}),n.onSuccess(i),!1}if(503===e.err){var a=dj.extend(e,{fsize:dj.fileSize(e.fsize),maxsize:dj.fileSize(e.maxsize)});dDialog.alertError(djTemplate.render("Không thể Upload tệp tin <b>{title}</b>, có lỗi dung lượng <b>{fsize}</b> vượt quá <b>{maxsize}</b>.",a))}else dDialog.alertError("Không thể Upload tệp tin, có lỗi "+e.msg)}}}; /*! * Tinymce editor v4.9 08/05/2022 * Copyright HoangNX */let dgtts={p5:{},o4:"https://eop.edu.vn",p2:{},l5:function(e,t){if(dj.isFunction(t)){let i=1e3*e.duration+this.p2.delta;setTimeout((function(){t(e)}),i)}return!1},speech:function(e){this.p2=dj.extend({cmd:"fullname",text:"",delta:500,callback:function(){return!1}},e),this.p2.text=dj.trim(this.p2.text);let t=dj.sec(this.p2.text);if(void 0!==this.p5[t]){let e=this.p5[t];return e.audio.play(),this.l5(e,this.p2.callback)}let i=this,a=this.o4+"/apps/open/text2speech/"+this.p2.cmd+"/"+djConfig.APPID+"/"+t.substr(5,15);return dj.getJSONP(a+"/"+this.p2.text.length,{text:this.p2.text},(function(e){if(0===e.err){let a="tts"+djConfig.APPID,n=i.o4+"/dgtts/"+i.p2.cmd+"/"+e.data.file,r=djTemplate.render('<audio src="{src}"><source type="audio/mp3" src="{src}" /></audio>',{src:n});document.getElementById(a)?dj("#"+a).html(r):dj('<div id="'+a+'" style="display:none">'+r+"</div>").appendTo(document.body);let o=dj("#"+a+">audio")[0],s={audio:o,duration:e.data.duration,size:e.data.size};i.p5[t]=s,o.play(),i.l5(s,i.p2.callback)}})),!1}};var img4cms={relatedImgs:function(e){var t=[];return dj(e+" .drelated img").each((function(){t.push(dj(this).attr("src"))})),t},captions:function(e){djLog("img4cms captions "+e),dj(e+" img").each((function(){var e=dj(this),t=["width","height"];if(!e.hasClass("dgmd")&&!e.hasClass("dgmv"))for(var i in t){var a=t[i],n=e.css(a);0!==n&&"0px"!==n||e.css(a,"auto")}})),dj(e+">.pCaption").each((function(e){var t=dj(this),i=t.prev(),a={},n=["text-align","width"];for(var r in n)a[c=n[r]]=t.css(c);if(i.html().indexOf("<img")>-1){var o="imgcaption"+e,s=dj("img:last",i),d=s.width();0===d&&(s.attr("rel",o),s.load((function(){var e=this;function t(){var t=dj(e),i=t.attr("rel");dj("#"+i).width(t.width())}t(),setTimeout((function(){t()}),1e3)}))),a.width=d+"px";var l=[];for(var c in a)l.push(c+":"+a[c]);i.append('<i id="'+o+'" class="iCaption" style="'+l.join(";")+'">'+t.html()+"</i>"),t.remove()}}))},a0:function(e,t){var i={margin:"0 auto"};e.hasClass("dgmedia")&&(i.height=0),e.css(i),t.removeClass("pCaption").addClass("pBody").css({"text-align":"center"})},forbody:function(e){djLog("img4cms forbody "+e);var t=this;dj(e+">.pCaption>img").each((function(){var e=dj(this),i=e.parent();if(""!==dj.trim(i.text())&&1===i.length){var a=i.text();t.a0(e,i),i.empty(),i.append(e),i.append('<i class="iCaption">'+a+"</i>")}})),dj(e+">.pCaption,"+e+">.pBody,"+e+">.pCenter").each((function(){var e=dj(this);e.html().indexOf("<img")>-1&&t.a0(dj("img",e),e)}))}},dmap=function(){var e=null,t=null;return{init:function(e){if(null===t){var i=document.createElement("script");i.type="text/javascript",i.src="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=dmap.p7",document.body.appendChild(i),t=dj.extend({zoom:16,by:"addr"},e)}else this.p7(dj.extend({zoom:16},e))},val:function(){return{by:t.by,lat:t.lat,lng:t.lng,zoom:t.zoom}},p7:function(e){void 0!==e&&(t=e),"addr"===t.by?this.loadFromAddress(t.addr):this.loadFromLatLng(t.lat,t.lng)},loadFromLatLng:function(e,t){this.l6(new google.maps.LatLng(e,t))},loadFromAddress:function(t){var i=this;null===e&&(e=new google.maps.Geocoder),e&&e.geocode({address:t},(function(e,t){t===google.maps.GeocoderStatus.OK?i.l6(e[0].geometry.location):alert("Geocode was not successful for the following reason: "+t)}))},l6:function(e){var i=this,a=new google.maps.Map(t.elmap,{zoom:t.zoom,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!1,disableDoubleClickZoom:!0});google.maps.event.addListener(a,"center_changed",(function(){var e=a.getCenter();t.lat=e.lat(),t.lng=e.lng()})),google.maps.event.addListener(a,"dblclick",(function(e){t.lat=e.latLng.lat(),t.lng=e.latLng.lng(),i.p8(t)})),google.maps.event.addListener(a,"zoom_changed",(function(){t.zoom=a.getZoom()}));var n=new google.maps.Marker({position:e,draggable:!0,map:a});google.maps.event.addListener(n,"dragend",(function(){var e=n.getPosition();a.panTo(e),t.lat=e.lat(),t.lng=e.lng(),i.p8(e)})),google.maps.event.addListener(n,"dblclick",(function(){t.zoom=a.getZoom()+1,t.zoom>=20&&(t.zoom=10),a.setZoom(t.zoom)}))},p8:function(e){null}}}(),dmedia=function(){var e=["application/kapsulefile","audio/mpeg","audio/x-ms-wma","audio/mid","audio/mp3","audio/ogg","audio/x-wav"],t=["application/octet-stream","video/x-flv","flv-application/octet-stream","application/x-shockwave-flash"],i=["video/mp4","video/wmv","video/mpeg","video/x-ms-asf","video/x-ms-wmv","video/webm","video/ogg"];return{a1:!1,l9:"",j9:!1,r3:!1,m0:"",m1:"",e8:"",m2:"",html5:!0,autoPlay:!1,isAudio:!1,isVideo:!1,isFlash:!1,os_device:function(){var e=window.navigator.userAgent;this.r3=e.indexOf("MSIE ");var t={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return t.Android()||t.BlackBerry()||t.iOS()||t.Opera()||t.Windows()}};return t},r4:function(a,n,r,o,s,d){this.m2=d,this.l9=a,""!==n&&null!==n||(n="/apps/open/media/thumb?p="+this.m2+"/video_default"),"//"===n.substring(0,2)&&(n=window.location.protocol+n),"//"===r.substring(0,2)&&(r=window.location.protocol+r),this.m0=n,this.m1=r,this.e8=o,this.autoPlay=s;var l=this.os_device();return this.j9=!(l.Android()||l.iOS()||!l.any()),this.a1=FlashDetect.installed,this.isAudio=dj.inArray(this.e8,e)>-1,this.isVideo=dj.inArray(this.e8,i)>-1,this.isFlash=dj.inArray(this.e8,t)>-1,this.html5=!this.isFlash,this},h6:function(){var e=djConfig.STATIC_URL+"flash/flvplayer.swf",t="file="+this.m1+"&amp;image="+this.m0,i='<embed name="'+this.l9+'" bgcolor="#000000" border="0" height="100%" width="100%" src="'+e+'" data="'+e+'"allowfullscreen="true" allownetworking="all" allowscriptaccess="always" pluginspage="http://www.macromedia.com/go/getflashplayer" wmode="transparent" loop="true" quality="high" play="true" type="application/x-shockwave-flash" flashvars="'+t+'" />';return this.r3>0&&dj.browser.version<=8?'<object id="'+this.l9+'" height="100%" width="100%" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"><param value="'+e+'" name="movie" /><param value="high" name="quality" /><param value="transparent" name="wmode" /><param value="true" name="allowfullscreen" /><param value="always" name="allowScriptAccess" /><param value="'+t+'" name="flashvars" />'+i+"</object>":'<object type="application/x-shockwave-flash" id="'+this.l9+'" data="'+e+'" height="100%" width="100%" /><param value="high" name="quality"><param value="transparent" name="wmode" /><param value="true" name="allowfullscreen" /><param value="always" name="allowScriptAccess" /><param value="'+t+'" name="flashvars" />'+i+"</object>"},canPlay:function(){return this.html5||this.a1},render:function(e){void 0===e&&(e=!0);var t=this;if(this.html5){var i={img:t.m0,src:t.m1,vw:'width="100%"',vh:'height="100%"'};if(i.play=this.autoPlay?'autoplay="true" play="true"':"",this.isAudio){i.ogg=i.src.replace(/.mp3/i,".ogg"),i.type=this.e8;return djTemplate.render('<audio type="{type}" class="dgadp" controls="" src="{src}"><source src="{ogg}" type="audio/mpeg" /></audio>',i)}var a=document.createElement("video");if(!(i.src.indexOf(".flv")>0||!dj.isFunction(a.canPlayType))&&!!a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")){var n="";function r(i){return'<video id="'+t.l9+'" class="dgvdp" poster="{img}" {play} preload="none" '+(e?'controls="controls" ':"")+'{vw} {vh} name="mediaplayer" controlslist="nodownload" onclick="return dmediaPlayVideo(this)"><img alt="" class="dgmv" src="{img}" id="'+t.l9+'ie8img" {vw} {vh}/>'+i+"</video>"}return i.src.indexOf(".mp4")>0&&a.canPlayType("video/mp4;codecs=avc1.42E01E,mp4a.40.2")&&(n=r('<source codecs="H.264" src="{src}" type="video/mp4"></source>')),i.src.indexOf(".webm")>0&&a.canPlayType("video/webm;")&&(n=r('<source src="{src}" type="video/webm"></source>')),(i.src.indexOf(".ogv")>0||i.src.indexOf(".ogg")>0)&&a.canPlayType("video/ogg;")&&(n=r('<source src="{src}" type="video/ogg"></source>')),djTemplate.render(n,i)}}return this.a1?t.h6():"Browser not support play this media"},playAudio:function(){var e='<source src="'+this.m1.replace(/.mp3/i,".ogg")+'" type="'+this.e8+'" />',t=dj("audio.dgadp").attr("src",this.m1).html(e);return this.autoPlay&&t[0].play(),t}}};function dmediaPlayVideo(e){return e.play(),!1}function dmediaScroll(e){var t=dj(e).not("[autoplay='autoplay']");function i(e,t){t?e.get(0).play():e.get(0).pause(),e.attr("play",t?1:0)}function a(){var e=dj(window).scrollTop(),a=e+100,n=e+dj(window).height()-100;t.each((function(e,t){var r=dj(this),o=r.offset().top,s=r.height()+o;i(r,a<s&&n>o)}))}window.addEventListener("scroll",a,!1),window.addEventListener("resize",a,!1)}var djaudio={m5:'<div class="{selector}" rel="{idx}"><audio class="hidden" src="{media}"><source type="{contenttype}" src="{media}" /></audio><div class="dta-main"> <a href="javascript:void(0);" onclick="return djaudio.play(this,{idx});" class="aud-btn play"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"> <path d="M8 5v14l11-7z"></path><path d="M0 0h24v24H0z" fill="none"></path> </svg> </a> <a href="javascript:void(0);" onclick="return djaudio.pause(this,{idx});" class="aud-btn pause hidden"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"> <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path><path d="M0 0h24v24H0z" fill="none"></path> </svg> </a> <div class="dt-graph prel"> <div class="aud-text"><span class="curent">0:0</span><span>/</span><span class="duration">{duration}</span></div> <div class="aud-bg"><div class="seek" style="width:0"></div></div> </div> <div class="speech-menu"> <a class="aud-btn speech " href="javascript:void(0);"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"> <path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"></path> <path d="M0 0h24v24H0z" fill="none"></path> </svg> </a> </div> <div class="aud-btn now baonoi">{title}</div></div></div>',audios:{},support:!1,selector:"djaudio",curentid:-1,curtime:-1,a2:500,playing:-1,option:{},e9:{},q4:function(e){return(e=parseInt(e))>9?e:"0"+e},f0:function(e){if(void 0!==e){var t=(e=e.replace(/\.(\d+)$/,"")).split(":");return t.length>=3?parseInt(t[0])>0?e:this.q4(t[1])+":"+this.q4(t[2]):e}return""},m6:function(e){var t=0,i=0;return e>=60*(i+1)&&(e>=3600*(t+1)&&(t=Math.floor(e/3600)),e-=3600*t+60*(i=Math.floor(e/60))),(t>0?this.q4(t)+":":"")+this.q4(i)+":"+this.q4(Math.floor(e))},a9:function(e,t){var i=e.currentTime;if(i>=e.duration)clearInterval(this.curtime),dj(".curent",t).text("00:00"),dj(".seek",t).css({width:0}),dj(".pause",t).addClass("hidden"),dj(".play",t).removeClass("hidden");else{var a=Math.floor(100*e.currentTime/e.duration);dj(".curent",t).text(this.m6(i)),dj(".seek",t).css({width:a+"%"})}},f1:function(e,t){var i=this;this.curtime=setInterval((function(){i.a9(e,t)}),this.a2)},k2:function(e,t,i){this.curentid=t;var a=this.audios[t];if("play"===e){var n=dj.sec(a.src);if(this.e9[n]||(this.e9[n]=0),this.e9[n]>=this.option.maxPlay)return this.option.onMaxPlayed(),!1;this.e9[n]++}dj("."+this.selector+" .play").removeClass("hidden"),dj("."+this.selector+" .pause").addClass("hidden"),t!==this.curentid&&this.curentid>-1&&(clearInterval(this.curtime),this.audios[this.curentid].pause()),a.play(),this.playing=t,this.option.onPlay();var r=i.parent();return i.addClass("hidden"),dj(".pause",r).removeClass("hidden"),a},play:function(e,t){var i=dj(e),a=this.k2("play",t,i);if(a){var n=i.parent().parent(),r=dj(".duration",n);""===dj.trim(r.text())&&r.text(this.m6(Math.round(a.duration))),this.f1(a,n)}return!1},pause:function(e,t){if(!this.option.allowPause)return!1;clearInterval(this.curtime),this.curentid=t;var i=dj(e),a=i.parent(),n=this.audios[t];return i.addClass("hidden"),n.pause(),this.playing=-1,this.option.onPause(),dj(".play",a).removeClass("hidden"),!1},init:function(e){null==e&&(e={});var t=this;this.support=Hls.isSupported(),this.option=dj.extend({allowSeek:!0,allowPause:!0,maxPlay:1e3,onPlay:function(e){dj.isFunction(e)&&e()},onPause:function(e){dj.isFunction(e)&&e()},onMaxPlayed:function(e){dWin.noise("Đã nghe quá số lần quy định."),dj.isFunction(e)&&e()}},e),dj("."+this.selector).each((function(){var e=dj(this),i=e.attr("rel"),a=dj("audio",e),n=dj("audio",e)[0],r=a.attr("src");if(r.indexOf(".m3u8")>0)if(t.support){var o=new Hls;o.loadSource(r),o.attachMedia(n)}else n.canPlayType("application/vnd.apple.mpegurl")&&(n.src=r);t.audios[i]=n,dj(".aud-bg",e).mousedown((function(e){if(!t.option.allowSeek)return dWin.noise("Không cho phép tua."),!1;var i=dj(this),a=i.parent().parent().parent(),n=a.attr("rel"),r=i.offset().left,o=(e.pageX-r)/i.width(),s=t.k2("seek",n,dj(".play",a));s&&(s.currentTime=o*s.duration,clearInterval(t.curtime),t.f1(s,a))}))}))}};function dmediaEmbed(e){var t={169:1.77778,916:.5625,43:1.33333,34:.75,23:.66667,32:1.5,11:1},i=document.getElementById("dcontent")?dj("#dcontent").width():dj(document).width();function a(e){return isNaN(e)||""===e?0:parseInt(e)}function n(e,t,i,a){for(var n in e){var o=e[n],s=new dmedia,d=o.id,l=t[d],c=l.element,u=l.attr,h=c.parent(),p=o.mediatype;if(!h.hasClass("dmedia")){var f=h.attr("class"),m=void 0===f||""===f?["pBody"]:f.split(" "),g=o.m3u8||"audio"===p;if(r.hls&&g){o.idx=parseInt(n)+1,o.autoplay=u.autoplay,o.autoplaystr=o.autoplay?"true":"false";var v=c.attr("data-title"),b="";if(o.title=dj.isNull(v)?"":v,"video"===p){o.ratio=u.ratio,o.advmode=a&&""!==o.vadid&&u.allowad?"true":"false",u.fullsize&&m.push("iFull"),o.width=u.width+"px",o.height=u.height+"px",o.cls=m.join(" ");b+=djTemplate.render('<div id="{id}" class="{cls} dvjmedia dvjm{ratio}"><div class="djvideostream" embed-type="{type}" data-width="{width}" data-height="{height}" videoid="{id}" data-info="{id}" data-namespace="{namespace}" data-title="{title}" data-duration="{duration}" data-encode="{encode}" data-autoplay="{autoplaystr}" data-advmode="{advmode}" data-ads="{vadtimes}" data-thumb="{thumb}" data-location="" data-vid="{media}" data-contentid=""></div></div>',o)}else"audio"===p&&(o.selector=djaudio.selector,o.duration=djaudio.f0(o.duration),b+=djTemplate.render(djaudio.m5,o));""!==b&&(h.replaceWith(b),h=dj("#"+d))}"video"===p&&(h.addClass("dg"+o.mediatype),h.addClass("dmedia"),u.width>0&&h.css({width:u.width+"px"}),u.height>0&&h.css({height:u.height+"px"})),c.css({width:"100%",height:"100%"}),g||(s.r4(d,o.thumb,o.media,o.contenttype,o.autoplay,o.uploader),l.element.replaceWith(s.render()))}}!r.hls&&i&&(dmedia().os_device().iOS()||dmediaScroll(".dmedia>video"))}var r=dj.extend({ismobile:dj.browser.ismobile,width:0,height:0,scale:t[169],allow_cdn:!0,hls:!1,id:"48",isAd:!0,type:1,useBg:!0,audio:null},e);r.height=0!==r.scale?Math.round(r.width/r.scale):0;var o,s,d,l,c,u=djConfig.DCDN.allow&&r.allow_cdn,h=djConfig.DCDN.domain,p="//"+h,f=(o=r,s={},d=[],l=!1,c=!1,dj("img.dgmedia,b.dgmedia").each((function(n){var r=dj(this),u=r.attr("data-encode"),h=r.attr("data-type"),p=function(e,t){if(!dj.isNull(e.style.width)){var i=e.style.width;return""===i||i.indexOf("%")>0?i:parseInt(i.replace("px",""))}return 0}(r[0]),f="true"===r.attr("data-autoplay");(""===p||0===p||o.ismobile)&&(p=e.width);var m=r.attr("data-args"),g={update:"10/11/2020",mobile:o.ismobile,duration:0,fullsize:!1,ratio:169,autoplay:f,allowad:!0,streamhls:!0,width:p,video_width:0,video_height:0};dj.isNull(m)||(m=m.split(":"),dj.extend(g,{duration:a(m[0]),fullsize:a(m[1])>0,ratio:a(m[2]),autoplay:a(m[3])>0,allowad:a(m[4])>0,streamhls:a(m[5])>0,width:o.ismobile?p:m[6],video_width:a(m[8]),video_height:a(m[9])}));var v,b,w,y,j=dj.sec(u),x="b"===this.tagName.toLowerCase()||"audio/mp3"===h?"audio":"video",C=(v=g.ratio,b=g.width,w=g.fullsize,{scale:y=dj.isNull(t[v])?t[169]:t[v],width:b=w?i:dj.isNumeric(b)?parseInt(b):b.indexOf("%")>0?Math.round(parseInt(b.replace("%"))*e.width/100):parseInt(b.replace("px","")),height:0===y?0:Math.round(b/y)});dj.extend(g,C,{type:x}),r.attr("id",j),d.push(u),s[j]={id:j,element:r,attr:g},"video"===x?l=!0:c=!0})),{encodes:d,items:s,video:l,audio:c});if(function(e,t){if(e&&t){var i=window.innerWidth>window.innerHeight,a=window.innerWidth;window.addEventListener("resize",(function(){var e=window.innerWidth>window.innerHeight;e!==i&&(i=e,dj(".dvjmedia").each((function(){var e=dj(this),t=dj(".djvideostream",e),i=parseFloat(t.attr("data-scale")),n=parseInt(t.attr("data-width").replace("px","")),r=Math.round(window.innerWidth*n/a),o={width:r+"px",height:Math.round(r/i)+"px"};e.css(o),dj(".djvideostream,.djvideostream .DjVideo,video",e).css(o),dj(".DjVideo-loading-vid-icon",e).remove()})))}))}}(r.ismobile,f.video),f.encodes.length>0){var m=f.encodes.join(";"),g=dj.sec(m).substring(0,25),v={dapp:djConfig.DOMAIN,ids:m,sec:g};u?(f.audio&&dj.loadStyle(p+"/dgrs/djmd/css/djaudio2.css"),dj.ajax({url:p+"/dgrs/djmd/js/player.dm3.js",dataType:"script",cache:!0,success:function(){var e=[p,"video","embeds",g,r.ismobile?"mobile":"desktop",r.hls?"1":"0"].join("/");(ids=window.location.href.match(/\/(\d+)\.htm/))&&(e+="?id="+ids[1]),dj.getJSONP(e,v,(function(e){0===e.err&&(n(e.data,f.items,f.video,r.isAd),f.video&&(djvideo.isAd=r.isAd,djvideo.domain=h,djvideo.serverUrl=p,djvideo.configs=e.djvideo,e.m3u8&&djvideo.init(".dvjmedia",r)),f.audio&&djaudio.init(r.audio))}),"djvideo"+g)}})):dj.getJSONP(djConfig.BASE_URL+"/apps/open/media/embeds",v,(function(e){0===e.err&&n(e.data,f.items,f.video,!1)}))}}!function(e){"use strict";var t={action:"/base/drop_upload",label:$DSTR.upload.dragfile,maxQueue:2,maxSize:5242880,postData:{},postKey:"file",debug:!1,init:function(e){},start:function(t,i){for(var a="",n=this,r=0;r<i.length;r++)a+='<li data-index="'+i[r].index+'"><input class="fileid" type="hidden"/><label>'+i[r].name+'</label> <a class="link" target="_blank">('+e.fileSize(i[r].size)+')</a><span>...</span> <b class="close"></b></li>';e("ul.filelists",t).append(a);for(r=0;r<i.length;r++)e('ul.filelists li[data-index="'+i[r].index+'"] b.close',t).click((function(i){i.stopPropagation();var a=e(this).parent();n.fileRemove(t,a.find("input.fileid").val(),a)}))},complete:function(e){dWin.noise($DSTR.upload.complete_all)},fileStart:function(t,i){e('ul.filelists li[data-index="'+i.index+'"] span',t).html("0%")},fileProgress:function(t,i,a){e('ul.filelists li[data-index="'+i.index+'"] span',t).html(a+"%")},fileComplete:function(t,i,a){var n=e('ul.filelists li[data-index="'+i.index+'"]',t);if(""===a||a.err>0)n.addClass("error").find("span").html(a.msg);else{var r=n.find('input[type="hidden"]'),o=n.find("a.link");r.val(a.data.fileid),o.attr("href",a.data.filelink),n.find("span").remove(),n.appendTo(e("ul.filelists",t)),this.fileSuccess(t,i,a,n,r,o)}},fileError:function(t,i,a){dDialog.alertError(i.name+":"+a),e('ul.filelists li[data-index="'+i.index+'"]',t).addClass("error").find("span").html(a)},fileSuccess:function(t,i,a,n,r,o){var s=a.data.fileid.split("@");n.find("label").html(s[1]),o.html("("+e.fileSize(parseInt(s[3]))+")"),e('<img src="'+djConfig.CDN_URL+"dgrs/img/filetype/"+s[2]+'.gif" />').insertBefore(r)},fileRemove:function(e,t,i){i.remove()}},i=function(e,t){this.r4(e,t)};i.prototype={element:null,queue:[],total:0,uploading:!1,constructor:i,p2:null,r4:function(i,a){if(window.File&&window.FileReader&&window.FileList){this.element=e(i),this.p2=e.extend({},t,a),this.s6("DropUpload init");var n=this,r='<form action="#"><div class="dropped dropper"><div class="dzone">'+this.p2.label+'</div><input type="file"';this.p2.maxQueue>1&&(r+=" multiple"),r+='/></div></form><ul class="filelists"></ul>',this.element.append(r),this.queue=[],this.total=0,this.uploading=!1;var o=this.element.find(".dropped"),s=this.element.find("input");return o.on("click",".dzone",(function(e){n.b0(e),s.trigger("click")})).on("dragenter",(function(t){n.b0(t),e(this).addClass("dropping")})).on("dragover",(function(t){n.b0(t),e(this).addClass("dropping")})).on("dragleave",(function(t){n.b0(t),e(this).removeClass("dropping")})).on("drop",".dzone",(function(t){t.preventDefault();var i=t.originalEvent.dataTransfer.files;e(this).removeClass("dropping"),n.d9(i)})),s.change((function(e){n.b0(e);var t=this.files;t.length&&n.d9(t)})),this.p2.init(this.element),this.element}return null},s6:function(e){this.p2.debug&&djLog(e)},b0:function(e){e.stopPropagation(),e.preventDefault()},d9:function(t){for(var i=[],a=0;a<t.length;a++){var n={index:this.total++,file:t[a],name:t[a].name,size:t[a].size,started:!1,complete:!1,error:!1,transfer:null};i.push(n),this.queue.push(n)}this.uploading||(e(window).on("beforeunload.dropper",(function(){return $DSTR.upload.pedding})),this.uploading=!0),this.p2.start(this.element,i),this.i4()},i4:function(){var t=0,i=[];for(var a in this.queue)!this.queue.hasOwnProperty(a)||this.queue[a].complete||this.queue[a].error||i.push(this.queue[a]);for(var n in this.queue=i,this.queue)if(this.queue.hasOwnProperty(n)){if(!this.queue[n].started){var r=new FormData;for(var o in r.append(this.p2.postKey,this.queue[n].file),this.p2.postData)this.p2.postData.hasOwnProperty(o)&&r.append(o,this.p2.postData[o]);this.i5(this.queue[n],r)}if(++t>=this.maxQueue)return;a++}0===t&&(e(window).off("beforeunload.dropper"),this.uploading=!1,this.p2.complete(this.element))},i5:function(t,i){if(t.size>this.p2.maxSize)t.error=!0,this.p2.fileError(this.element,t,$DSTR.upload.toolarge),this.i4();else{var a=this;t.started=!0,t.transfer=e.ajax({url:this.p2.action,data:i,dataType:"json",type:"POST",contentType:!1,processData:!1,cache:!1,xhr:function(){var i=e.ajaxSettings.xhr();return i.upload&&i.upload.addEventListener("progress",(function(e){var i=0,n=e.loaded||e.position,r=e.total;e.lengthComputable&&(i=Math.ceil(n/r*100)),a.p2.fileProgress(a.element,t,i)}),!1),i},beforeSend:function(e){a.p2.fileStart(a.element,t)},success:function(e,i,n){t.complete=!0,a.p2.fileComplete(a.element,t,e,i,n),a.i4()},error:function(e,i,n){t.error=!0,a.p2.fileError(a.element,t,n,i,e),a.i4()}})}}},e.fn.dropUpload=function(t){return this.each((function(){var a=e(this),n=a.data("i3");n||(n=new i(this,"object"==typeof t&&t),a.data("i3",n))})).data("i3")}}(djCore); /*! * Widget v2.5 31/07/2022 * Copyright HoangNX */ var dWidget={time:function(){dj.wgTime()},repMsg:function(e){dj.isNull(e)&&(e="mrep"),dj("."+e).each((function(){var t=dj(this),i=t.html();""!==i&&t.html(dj.repMessage(i)).removeClass(e)}))},emotions:function(){dj(".emotion").emotions({handle:"#etoggle",css:"ecls"}),dj(".emotion").removeClass("emotion")},o8:function(e){return djConfig.FRAMEWORK_URL+e},k4:function(e,t){var i=[];for(var a in e)a>0&&-1===dj.inArray(a,i)&&(i.push(a),i.length>=50&&(t(i),i=[]));i.length>0&&t(i)},getUser:function(e,t){dj.getJSONP(djConfig.FRAMEWORK_URL+"modules/goku/widget/getUser?u="+e.join("|"),(function(e){t(e)}))},user:function(){var e={},t=this;dj(".avatar,.display").each((function(){var i=this.getAttribute("rel");if(i&&""!==i){var a=dj(this);if(a.hasClass("avatar")){var n=this.tagName,r=this.getAttribute("wid");if(r?(r=parseInt(r),this.removeAttribute("wid")):r=50,50===r||100===r||150===r){var o=t.o8("avatar/"+i+(50===r?"":"/"+r));"IMG"===n?this.setAttribute("src",o):this.innerHTML='<img style="width:50px;height:50px" src="'+o+'" />'}}else e[i]=1,a.addClass("dwgU"+i),a.hasClass("viewcard")&&a.click((function(){return dj.getJSONP(djConfig.FRAMEWORK_URL+"modules/goku/widget/user/info/"+i,(function(e){0===e.err&&(e.data.ngaysinh=e.data.birthday.day+"/"+e.data.birthday.month+"/"+e.data.birthday.year,dDialog.openContent(djTemplate.render('<div class="dcard"><span class="label label-success pull-right">{jobtitle}</span> <div class="media clearfix"> <a class="pull-left"><img alt="logo" class="img-circle m-b" src="{picture}"/></a> <div class="media-body"> <img class="qrcode" src="{qrcode}" /> <h5><a href="/{name}">{display}</a></h5> <div class="text-muted font-bold m-b-xs">{mobile}</div> <p>{email}</p> </div> </div> <p>Ngày sinh: <b>{ngaysinh}</b></p> <p><b class="position" rel="{positionid}"></b> / <b class="department" rel="{departmentid}"></b></p> <p>Thường trú: <b>{address}</b></p> <p>Quê quán: <b class="location huyen" rel="{location}"></b></p></div>',e.data),"Thông tin "+e.data.display,{modal:!1,afterShow:function(){dWidget.location(),dWidget.department(),dWidget.position(),dj(".ucard tr:odd").addClass("odd")}}))}),"duserinfo"),!1}));this.removeAttribute("rel")}})),this.k4(e,(function(e){dj.getJSONP(t.o8("widget/user"),{q:e.join(".")},(function(e){if(0===e.err)for(var t in e.data){var i=e.data[t],a=i[0],n=i[1];dj(".dwgU"+t).each((function(){var e=dj(this);n&&""!==n&&e.hasClass("username")?e.html(n):(e.hasClass("lastname")&&(a=dj.lastName(a)),a&&""!==a&&e.html(a)),e.removeClass("dwgU"+t)}))}}),"widget_user")}))},get_department:function(e,t){void 0===t&&(t=0),dj.getJSONP(this.o8("widget/departments"),{q:t},(function(t){e(t)}),"widget_departments")},department:function(){var e={},t=this;dj(".department").each((function(){var t=this.getAttribute("rel");t&&""!==t&&(e[t]=1,dj(this).addClass("dwgD"+t),this.removeAttribute("rel"))})),this.k4(e,(function(e){dj.getJSONP(t.o8("widget/department"),{q:e.join(".")},(function(e){if(0===e.err)for(var t in e.data){var i=e.data[t];dj(".dwgD"+t).each((function(){var e=dj(this);i&&""!==i&&e.html(i),e.removeClass("dwgD"+t)}))}}),"widget_department")}))},get_location:function(e,t){void 0===t&&(t=1),dj.getJSONP(this.o8("widget/locations"),{q:t},(function(t){e(t)}),"widget_locations")},location:function(){var e={},t=this;dj(".location").each((function(){var t=this.getAttribute("rel");t&&""!==t&&parseInt(t)>0&&(e[t]=1,dj(this).addClass("dwgL"+t),this.removeAttribute("rel"))})),this.k4(e,(function(e){dj.getJSONP(t.o8("widget/location"),{q:e.join(".")},(function(e){if(0===e.err)for(var t in e.data){var i=e.data[t],a=i[1],n=i[0];dj(".dwgL"+t).each((function(){var e=dj(this),i="";""!==n&&e.hasClass("huyen")&&(i+=n),""!==a&&(i+=(""!==i?"-":"")+a),e.html(i),e.removeClass("dwgL"+t)}))}}),"widget_location")}))},get_position:function(e){dj.getJSONP(this.o8("widget/positions"),(function(t){e(t)}),"widget_positions")},position:function(){var e={},t=this;dj(".position").each((function(){var t=this.getAttribute("rel");t&&""!==t&&(e[t]=1,dj(this).addClass("dwgP"+t),this.removeAttribute("rel"))})),this.k4(e,(function(e){dj.getJSONP(t.o8("widget/position"),{q:e.join(".")},(function(e){if(0===e.err)for(var t in e.data){var i=e.data[t];dj(".dwgP"+t).each((function(){var e=dj(this);i&&""!==i&&e.html(i),e.removeClass("dwgP"+t)}))}}),"widget_position")}))}};